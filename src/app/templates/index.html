{% extends "base.html" %}

{% block content %}
<!-- ヒーローセクション -->
<section class="min-h-screen flex items-center justify-center relative overflow-hidden">
    <!-- 背景アニメーション -->
    <div class="absolute inset-0 overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-full">
            <div class="text-9xl font-bold text-gray-800/10 whitespace-nowrap animate-scroll-text">
                AI GAME SOUND GENERATOR • AI GAME SOUND GENERATOR • AI GAME SOUND GENERATOR •
            </div>
        </div>
        <!-- パーティクルエフェクト -->
        <div id="particles-container"></div>
    </div>

    <div class="container mx-auto px-4 py-16 relative z-10">
        <div class="text-center space-y-8 animate-fade-in-up">
            <!-- タイトル -->
            <h1 class="text-7xl md:text-8xl font-bold mb-6">
                <span
                    class="bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400 bg-clip-text text-transparent neon-text animate-gradient">
                    AI Game Sound
                </span>
                <br>
                <span
                    class="bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent neon-text animate-gradient"
                    style="animation-delay: 0.5s">
                    Generator
                </span>
            </h1>

            <!-- サブタイトル -->
            <p class="text-2xl md:text-3xl text-gray-300 font-light animate-fade-in" style="animation-delay: 0.8s">
                AIで、ゲームサウンドを、みんなの手に。
            </p>

            <!-- 説明文 -->
            <div class="max-w-3xl mx-auto text-lg text-gray-400 space-y-4 animate-fade-in" style="animation-delay: 1s">
                <p>
                    最先端のAI技術を活用して、あなたのゲームにぴったりな
                    オリジナルサウンドトラックを瞬時に生成。
                </p>
                <p class="text-sm">
                    Tokyo Game Show 2025 Special Demo
                </p>
            </div>

            <!-- CTAボタン -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center mt-12 animate-fade-in"
                style="animation-delay: 1.2s">
                <button onclick="document.getElementById('generator-section').scrollIntoView({behavior: 'smooth'})"
                    class="px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full font-bold text-lg hover:shadow-xl hover:shadow-purple-500/50 transform hover:scale-105 transition-all duration-300">
                    今すぐ試す
                </button>
                <button onclick="document.getElementById('features-section').scrollIntoView({behavior: 'smooth'})"
                    class="px-8 py-4 glass border border-white/20 rounded-full font-bold text-lg hover:bg-white/10 transform hover:scale-105 transition-all duration-300">
                    機能を見る
                </button>
            </div>

            <!-- スクロール誘導 -->
            <div class="mt-12 animate-bounce">
                <svg class="w-6 h-6 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                </svg>
            </div>
        </div>
    </div>
</section>

<!-- 機能説明セクション -->
<section id="features-section" class="py-24 relative">
    <div class="container mx-auto px-4">
        <div class="text-center mb-16">
            <h2
                class="text-5xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                3つの特徴
            </h2>
            <p class="text-xl text-gray-400">簡単・高速・高品質なサウンド生成</p>
        </div>

        <div class="grid md:grid-cols-3 gap-8">
            <!-- 特徴1 -->
            <div
                class="glass rounded-2xl p-8 hover:shadow-xl hover:shadow-purple-500/20 transition-all duration-300 hover:-translate-y-2 feature-card">
                <div
                    class="w-16 h-16 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full flex items-center justify-center mb-6">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <h3 class="text-2xl font-bold mb-4">瞬時に生成</h3>
                <p class="text-gray-400">
                    タグを選択するだけで、数秒でオリジナルのゲームサウンドが完成。
                    待ち時間なく、すぐに試聴・ダウンロードが可能です。
                </p>
            </div>

            <!-- 特徴2 -->
            <div class="glass rounded-2xl p-8 hover:shadow-xl hover:shadow-pink-500/20 transition-all duration-300 hover:-translate-y-2 feature-card"
                style="animation-delay: 0.1s">
                <div
                    class="w-16 h-16 bg-gradient-to-r from-pink-500 to-pink-600 rounded-full flex items-center justify-center mb-6">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4">
                        </path>
                    </svg>
                </div>
                <h3 class="text-2xl font-bold mb-4">直感的な操作</h3>
                <p class="text-gray-400">
                    ジャンル、ムード、シーンなどのタグを選ぶだけ。
                    音楽知識がなくても、プロ品質のサウンドを作成できます。
                </p>
            </div>

            <!-- 特徴3 -->
            <div class="glass rounded-2xl p-8 hover:shadow-xl hover:shadow-blue-500/20 transition-all duration-300 hover:-translate-y-2 feature-card"
                style="animation-delay: 0.2s">
                <div
                    class="w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-6">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3">
                        </path>
                    </svg>
                </div>
                <h3 class="text-2xl font-bold mb-4">多彩な表現</h3>
                <p class="text-gray-400">
                    RPGからアクション、ホラーまで幅広いジャンルに対応。
                    楽器やテンポも自由に組み合わせて、理想のサウンドを実現。
                </p>
            </div>
        </div>
    </div>
</section>

<!-- 使い方セクション -->
<section class="py-16 md:py-24 relative bg-gradient-to-b from-transparent to-purple-900/10 overflow-hidden">
    <!-- 背景波形アニメーション -->
    <div class="wave-container">
        <div class="wave"></div>
    </div>

    <div class="container mx-auto px-4 relative z-10">
        <div class="text-center mb-12 md:mb-16">
            <h2
                class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                かんたん3ステップ
            </h2>
            <p class="text-lg md:text-xl text-gray-400">誰でも簡単にゲームサウンドを作成</p>
        </div>

        <div class="max-w-4xl mx-auto">
            <!-- ステップコンテナ -->
            <div class="space-y-12 md:space-y-16">
                <!-- ステップ1 -->
                <div class="flex flex-col md:flex-row items-center text-center md:text-left step-item group">
                    <div class="relative">
                        <div
                            class="flex-shrink-0 w-16 h-16 md:w-20 md:h-20 bg-gradient-to-r from-purple-600 to-purple-500 rounded-full flex items-center justify-center text-xl md:text-2xl font-bold mb-4 md:mb-0 z-10 transition-all duration-300 group-hover:scale-110 group-hover:shadow-lg group-hover:shadow-purple-500/50">
                            1
                        </div>
                        <!-- 垂直接続ライン（モバイル用） -->
                        <div
                            class="md:hidden absolute top-20 left-1/2 transform -translate-x-1/2 w-0.5 h-16 bg-gradient-to-b from-purple-500 to-transparent">
                        </div>
                    </div>
                    <div class="md:ml-8 flex-grow max-w-2xl">
                        <h3 class="text-xl md:text-2xl font-bold mb-2 group-hover:text-purple-400 transition-colors">
                            タグを選択</h3>
                        <p class="text-gray-400 text-sm md:text-base group-hover:text-gray-300 transition-colors">
                            ジャンル、ムード、シーンなど、作りたい音楽のイメージに合うタグを選びます</p>
                        <!-- アイコンアニメーション -->
                        <div class="mt-4 flex justify-center md:justify-start space-x-2">
                            <span class="inline-block w-8 h-8 bg-purple-600/20 rounded animate-pulse"
                                style="animation-delay: 0s"></span>
                            <span class="inline-block w-8 h-8 bg-pink-600/20 rounded animate-pulse"
                                style="animation-delay: 0.2s"></span>
                            <span class="inline-block w-8 h-8 bg-blue-600/20 rounded animate-pulse"
                                style="animation-delay: 0.4s"></span>
                        </div>
                    </div>
                </div>

                <!-- ステップ2 -->
                <div class="flex flex-col md:flex-row items-center text-center md:text-left step-item group"
                    style="animation-delay: 0.2s">
                    <div class="relative">
                        <div
                            class="flex-shrink-0 w-16 h-16 md:w-20 md:h-20 bg-gradient-to-r from-pink-600 to-pink-500 rounded-full flex items-center justify-center text-xl md:text-2xl font-bold mb-4 md:mb-0 z-10 transition-all duration-300 group-hover:scale-110 group-hover:shadow-lg group-hover:shadow-pink-500/50">
                            2
                        </div>
                        <!-- 垂直接続ライン（モバイル用） -->
                        <div
                            class="md:hidden absolute top-20 left-1/2 transform -translate-x-1/2 w-0.5 h-16 bg-gradient-to-b from-pink-500 to-transparent">
                        </div>
                    </div>
                    <div class="md:ml-8 flex-grow max-w-2xl">
                        <h3 class="text-xl md:text-2xl font-bold mb-2 group-hover:text-pink-400 transition-colors">AIが生成
                        </h3>
                        <p class="text-gray-400 text-sm md:text-base group-hover:text-gray-300 transition-colors">
                            選択したタグを基に、AIが最適なプロンプトを作成し、音楽を自動生成します</p>
                        <!-- ローディングアニメーション -->
                        <div class="mt-4 flex justify-center md:justify-start">
                            <div class="w-32 h-2 bg-gray-700 rounded-full overflow-hidden">
                                <div class="h-full bg-gradient-to-r from-pink-500 to-purple-500 rounded-full"
                                    style="animation: loading 2s ease-in-out infinite"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ステップ3 -->
                <div class="flex flex-col md:flex-row items-center text-center md:text-left step-item group"
                    style="animation-delay: 0.4s">
                    <div class="relative">
                        <div
                            class="flex-shrink-0 w-16 h-16 md:w-20 md:h-20 bg-gradient-to-r from-blue-600 to-blue-500 rounded-full flex items-center justify-center text-xl md:text-2xl font-bold mb-4 md:mb-0 z-10 transition-all duration-300 group-hover:scale-110 group-hover:shadow-lg group-hover:shadow-blue-500/50">
                            3
                        </div>
                    </div>
                    <div class="md:ml-8 flex-grow max-w-2xl">
                        <h3 class="text-xl md:text-2xl font-bold mb-2 group-hover:text-blue-400 transition-colors">
                            ダウンロード</h3>
                        <p class="text-gray-400 text-sm md:text-base group-hover:text-gray-300 transition-colors">
                            生成された音楽を試聴して、気に入ったらすぐにダウンロード可能です</p>
                        <!-- ダウンロードアイコン -->
                        <div class="mt-4 flex justify-center md:justify-start">
                            <svg class="w-8 h-8 text-blue-500 animate-bounce" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10">
                                </path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ジェネレーターセクション -->
<section id="generator-section" class="py-24">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <h2
                class="text-5xl font-bold mb-4 bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400 bg-clip-text text-transparent">
                サウンドジェネレーター
            </h2>
            <p class="text-xl text-gray-400">さあ、あなただけのゲームサウンドを作ろう</p>
        </div>

        <!-- メインコンテンツ -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8" x-data="musicGenerator()" x-init="init()">

            <!-- 左側: タグ選択パネル -->
            <div class="lg:col-span-1">
                <div class="glass rounded-2xl p-6 shadow-2xl hover:shadow-3xl transition-shadow duration-300">
                    <h2 class="text-2xl font-bold mb-6 text-purple-300 flex items-center">
                        <svg class="w-7 h-7 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3">
                            </path>
                        </svg>
                        音楽生成設定
                    </h2>

                    <!-- ローディング表示 -->
                    <div x-show="isLoading" class="text-center py-8">
                        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"></div>
                        <p class="mt-2 text-gray-400">タグデータを読み込み中...</p>
                    </div>

                    <!-- タグ選択エリア -->
                    <div x-show="!isLoading">
                        <!-- ジャンル -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3 text-gray-200 flex items-center">
                                <div
                                    class="flex items-center bg-gradient-to-r from-yellow-500/20 to-yellow-400/10 rounded-full px-3 py-1 mr-3">
                                    <svg class="w-4 h-4 text-yellow-400 mr-1" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                                        </path>
                                    </svg>
                                    <span class="text-xs text-yellow-400 font-medium">1つのみ</span>
                                </div>
                                <svg class="w-5 h-5 text-purple-400 mr-2" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M7 4v16M17 4v16M3 8h4m10 0h4M3 16h4m10 0h4"></path>
                                </svg>
                                ジャンル
                            </h3>
                            <div class="grid grid-cols-2 gap-2">
                                <template x-for="genre in genres">
                                    <button @click="toggleTag('genre', genre.name)"
                                        :disabled="selectedTags.genre.length > 0 && !selectedTags.genre.includes(genre.name)"
                                        :class="{
                                    'bg-gradient-to-r from-purple-600 to-purple-500 border-purple-400 shadow-lg shadow-purple-500/50 scale-105 ring-2 ring-purple-400/50': selectedTags.genre.includes(genre.name),
                                    'bg-gray-800/50 border-gray-600 hover:border-purple-400 hover:bg-gray-700/50': !selectedTags.genre.includes(genre.name) && selectedTags.genre.length === 0,
                                    'bg-gray-900/30 border-gray-700/50 opacity-30 cursor-not-allowed': selectedTags.genre.length > 0 && !selectedTags.genre.includes(genre.name)
                                }" class="px-3 py-2 rounded-lg border-2 transition-all duration-200 text-sm relative overflow-hidden group">
                                        <span class="relative z-10" x-text="genre.name_ja || genre.name"></span>
                                        <div x-show="selectedTags.genre.includes(genre.name)"
                                            class="absolute top-1 right-1">
                                            <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd"
                                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                                    clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                    </button>
                                </template>
                            </div>
                        </div>

                        <!-- ムード -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3 text-gray-200 flex items-center">
                                <div
                                    class="flex items-center bg-gradient-to-r from-yellow-500/20 to-yellow-400/10 rounded-full px-3 py-1 mr-3">
                                    <svg class="w-4 h-4 text-yellow-400 mr-1" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                                        </path>
                                    </svg>
                                    <span class="text-xs text-yellow-400 font-medium">1つのみ</span>
                                </div>
                                <svg class="w-5 h-5 text-pink-400 mr-2" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                                    </path>
                                </svg>
                                ムード
                            </h3>
                            <div class="grid grid-cols-2 gap-2">
                                <template x-for="mood in moods">
                                    <button @click="toggleTag('mood', mood.name)"
                                        :disabled="selectedTags.mood.length > 0 && !selectedTags.mood.includes(mood.name)"
                                        :class="{
                                    'bg-gradient-to-r from-pink-600 to-pink-500 border-pink-400 shadow-lg shadow-pink-500/50 scale-105 ring-2 ring-pink-400/50': selectedTags.mood.includes(mood.name),
                                    'bg-gray-800/50 border-gray-600 hover:border-pink-400 hover:bg-gray-700/50': !selectedTags.mood.includes(mood.name) && selectedTags.mood.length === 0,
                                    'bg-gray-900/30 border-gray-700/50 opacity-30 cursor-not-allowed': selectedTags.mood.length > 0 && !selectedTags.mood.includes(mood.name)
                                }" class="px-3 py-2 rounded-lg border-2 transition-all duration-200 text-sm relative overflow-hidden group">
                                        <span class="relative z-10" x-text="mood.name_ja || mood.name"></span>
                                        <div x-show="selectedTags.mood.includes(mood.name)"
                                            class="absolute top-1 right-1">
                                            <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd"
                                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                                    clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                    </button>
                                </template>
                            </div>
                        </div>

                        <!-- シーン -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3 text-gray-200 flex items-center">
                                <div
                                    class="flex items-center bg-gradient-to-r from-blue-500/20 to-blue-400/10 rounded-full px-3 py-1 mr-3">
                                    <svg class="w-4 h-4 text-blue-400 mr-1" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z">
                                        </path>
                                    </svg>
                                    <span class="text-xs text-blue-400 font-medium"
                                        x-text="`${selectedTags.scene.length}/2`"></span>
                                </div>
                                <svg class="w-5 h-5 text-blue-400 mr-2" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z">
                                    </path>
                                </svg>
                                シーン
                            </h3>
                            <div class="grid grid-cols-2 gap-2">
                                <template x-for="scene in scenes">
                                    <button @click="toggleTag('scene', scene.name)"
                                        :disabled="selectedTags.scene.length >= 2 && !selectedTags.scene.includes(scene.name)"
                                        :class="{
                                    'bg-gradient-to-r from-blue-600 to-blue-500 border-blue-400 shadow-lg shadow-blue-500/50 scale-105 ring-2 ring-blue-400/50': selectedTags.scene.includes(scene.name),
                                    'bg-gray-800/50 border-gray-600 hover:border-blue-400 hover:bg-gray-700/50': !selectedTags.scene.includes(scene.name) && selectedTags.scene.length < 2,
                                    'bg-gray-900/30 border-gray-700/50 opacity-30 cursor-not-allowed': selectedTags.scene.length >= 2 && !selectedTags.scene.includes(scene.name)
                                }" class="px-3 py-2 rounded-lg border-2 transition-all duration-200 text-sm relative overflow-hidden group">
                                        <span class="relative z-10" x-text="scene.name_ja || scene.name"></span>
                                        <div x-show="selectedTags.scene.includes(scene.name)"
                                            class="absolute top-1 right-1">
                                            <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd"
                                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                                    clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                    </button>
                                </template>
                            </div>
                        </div>

                        <!-- 楽器 -->
                        <div class="mb-6" x-show="instruments.length > 0">
                            <h3 class="text-lg font-semibold mb-3 text-gray-200 flex items-center">
                                <svg class="w-5 h-5 text-green-400 mr-2" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3">
                                    </path>
                                </svg>
                                楽器
                                <span class="ml-2 text-xs text-gray-400" x-show="selectedTags.instrument.length > 0"
                                    x-text="`(${selectedTags.instrument.length}選択中)`"></span>
                            </h3>
                            <div class="grid grid-cols-2 gap-2">
                                <template x-for="instrument in instruments">
                                    <button @click="toggleTag('instrument', instrument.name)"
                                        :class="selectedTags.instrument && selectedTags.instrument.includes(instrument.name) ? 'bg-gradient-to-r from-green-600 to-green-500 border-green-400 shadow-lg shadow-green-500/50 scale-105' : 'bg-gray-800/50 border-gray-600 hover:border-green-400 hover:bg-gray-700/50'"
                                        class="px-3 py-2 rounded-lg border-2 transition-all duration-200 text-sm relative overflow-hidden">
                                        <span class="relative z-10"
                                            x-text="instrument.name_ja || instrument.name"></span>
                                        <div x-show="selectedTags.instrument && selectedTags.instrument.includes(instrument.name)"
                                            class="absolute top-1 right-1">
                                            <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd"
                                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                                    clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                    </button>
                                </template>
                            </div>
                        </div>

                        <!-- テンポ -->
                        <div class="mb-6" x-show="tempos.length > 0">
                            <h3 class="text-lg font-semibold mb-3 text-gray-200 flex items-center">
                                <svg class="w-5 h-5 text-yellow-400 mr-2" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                テンポ
                            </h3>
                            <div class="grid grid-cols-2 gap-2">
                                <template x-for="tempo in tempos">
                                    <button @click="toggleTag('tempo', tempo.name)"
                                        :disabled="selectedTags.tempo.length > 0 && !selectedTags.tempo.includes(tempo.name)"
                                        :class="{
                                    'bg-gradient-to-r from-yellow-600 to-yellow-500 border-yellow-400 shadow-lg shadow-yellow-500/50 scale-105 ring-2 ring-yellow-400/50': selectedTags.tempo.includes(tempo.name),
                                    'bg-gray-800/50 border-gray-600 hover:border-yellow-400 hover:bg-gray-700/50': !selectedTags.tempo.includes(tempo.name) && selectedTags.tempo.length === 0,
                                    'bg-gray-900/30 border-gray-700/50 opacity-30 cursor-not-allowed': selectedTags.tempo.length > 0 && !selectedTags.tempo.includes(tempo.name)
                                }" class="px-3 py-2 rounded-lg border-2 transition-all duration-200 text-sm relative overflow-hidden">
                                        <span class="relative z-10" x-text="tempo.name_ja || tempo.name"></span>
                                        <div x-show="selectedTags.tempo.includes(tempo.name)"
                                            class="absolute top-1 right-1">
                                            <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd"
                                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                                    clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                    </button>
                                </template>
                            </div>
                        </div>

                        <!-- 音楽の長さ -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3 text-gray-200 flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                音楽の長さ
                            </h3>
                            <!-- シークバー風のUI -->
                            <div class="space-y-3">
                                <div class="flex items-center space-x-3">
                                    <span class="text-xs text-gray-400 w-12">0:30</span>
                                    <input type="range" x-model="duration" min="30" max="180" step="30"
                                        class="flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"
                                        style="background: linear-gradient(to right, #9333ea 0%, #9333ea " x-text="`${(duration - 30) / 150 * 100}%`" + ", #374151 " x-text="`${(duration - 30) / 150 * 100}%`" + ", #374151 100%);">
                                    <span class="text-xs text-gray-400 w-12 text-right">3:00</span>
                                </div>
                                <!-- 現在選択中の時間を大きく表示 -->
                                <div class="text-center">
                                    <span class="text-2xl font-bold text-purple-400" x-text="formatTime(duration)"></span>
                                </div>
                            </div>
                        </div>

                        <!-- 生成ボタン -->
                        <button @click="generateMusic()" :disabled="!canGenerate()"
                            :class="canGenerate() ? 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700' : 'bg-gray-700 cursor-not-allowed'"
                            class="w-full py-3 px-4 rounded-xl font-bold transition-all duration-200 transform hover:scale-105">
                            <span x-show="!isGenerating" class="flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z">
                                    </path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                音楽を生成
                            </span>
                            <span x-show="isGenerating" class="flex items-center justify-center">
                                <svg class="animate-spin h-5 w-5 mr-3" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4" fill="none"></circle>
                                    <path class="opacity-75" fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                    </path>
                                </svg>
                                生成中...
                            </span>
                        </button>
                    </div><!-- タグ選択エリア終了 -->
                </div>
            </div>

            <!-- 右側: 生成結果パネル -->
            <div class="lg:col-span-2">
                <div
                    class="glass rounded-2xl p-6 shadow-2xl min-h-[600px] hover:shadow-3xl transition-shadow duration-300">
                    <h2 class="text-2xl font-bold mb-6 text-purple-300 flex items-center">
                        <svg class="w-7 h-7 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z">
                            </path>
                        </svg>
                        生成結果
                    </h2>

                    <!-- 結果表示エリア -->
                    <div x-show="!generatedMusic && !isGenerating" class="flex items-center justify-center h-96">
                        <div class="text-center">
                            <svg class="w-24 h-24 mx-auto mb-4 text-gray-600" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
                                    d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3">
                                </path>
                            </svg>
                            <p class="text-gray-400">左側でタグを選択して、音楽を生成してください</p>
                        </div>
                    </div>

                    <!-- 生成中アニメーション -->
                    <div x-show="isGenerating" class="flex flex-col items-center justify-center h-96">
                        <div class="relative">
                            <div class="w-32 h-32 border-t-4 border-purple-500 border-solid rounded-full animate-spin">
                            </div>
                            <div class="absolute top-0 left-0 w-32 h-32 border-r-4 border-pink-500 border-solid rounded-full animate-spin"
                                style="animation-delay: 0.2s; animation-direction: reverse;"></div>
                        </div>
                        <p class="mt-8 text-lg" x-text="generatingMessage"></p>
                        <div class="w-64 bg-gray-700 rounded-full h-2 mt-4">
                            <div class="bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-500"
                                :style="`width: ${progress}%`"></div>
                        </div>
                    </div>

                    <!-- 生成完了時の表示 -->
                    <div x-show="generatedMusic && !isGenerating">
                        <!-- プロンプト表示 -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3 text-gray-200">生成プロンプト</h3>
                            <div class="bg-gray-900 rounded-lg p-4 font-mono text-sm text-green-400"
                                x-text="generatedPrompt"></div>
                        </div>

                        <!-- 音楽プレイヤー -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3 text-gray-200">生成された音楽</h3>
                            <div class="bg-gradient-to-r from-purple-900 to-pink-900 rounded-xl p-6">
                                <audio controls class="w-full" x-show="audioUrl" :src="audioUrl"></audio>
                                <div x-show="!audioUrl" class="text-center py-4">
                                    <p class="text-yellow-400 flex items-center justify-center">
                                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                                            </path>
                                        </svg>
                                        音声データはデモモードのため生成されていません
                                    </p>
                                    <p class="text-sm text-gray-400 mt-2">ElevenLabs APIキーを設定すると実際の音楽が生成されます</p>
                                </div>
                                <!-- ビジュアライザー（装飾） -->
                                <div class="flex items-center justify-center space-x-1 mt-4">
                                    <template x-for="i in 20">
                                        <div class="w-1 bg-gradient-to-t from-purple-400 to-pink-400 rounded-full animate-pulse"
                                            :style="`height: ${Math.random() * 40 + 10}px; animation-delay: ${Math.random() * 2}s`">
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>

                        <!-- アクションボタン -->
                        <div class="flex space-x-4">
                            <a :href="downloadUrl" :download="`generated_music_${duration}s.mp3`"
                                class="flex-1 bg-purple-600 hover:bg-purple-700 py-3 px-4 rounded-lg transition-colors flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                </svg>
                                ダウンロード
                            </a>
                            <button @click="resetGenerator()"
                                class="flex-1 bg-gray-700 hover:bg-gray-600 py-3 px-4 rounded-lg transition-colors flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
                                    </path>
                                </svg>
                                新規生成
                            </button>
                        </div>

                        <!-- 生成情報 -->
                        <div class="mt-6 p-4 bg-gray-800 rounded-lg">
                            <h4 class="font-semibold mb-2">生成情報</h4>
                            <div class="text-sm text-gray-400 space-y-1">
                                <p>• 生成時間: <span x-text="generationTime"></span>秒</p>
                                <p>• ファイルサイズ: <span x-text="fileSize"></span></p>
                                <p>• 長さ: <span x-text="duration"></span>秒</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- フッター -->
<footer class="py-12 border-t border-gray-800">
    <div class="container mx-auto px-4 text-center">
        <p class="text-gray-400">© 2025 AI Game Sound Generator - Tokyo Game Show 2025 Demo</p>
        <p class="text-sm text-gray-500 mt-2">Powered by Advanced AI Technology</p>
    </div>
</footer>

<script>
    function musicGenerator() {
        return {
            // 初期化フラグ
            isLoading: true,

            // タグデータ（初期化時にAPIから取得）
            tagData: {},
            genres: [],
            moods: [],
            scenes: [],
            instruments: [],
            tempos: [],
            eras: [],
            regions: [],

            // 選択状態
            selectedTags: {
                genre: [],
                mood: [],
                scene: [],
                instrument: [],
                tempo: [],
                era: [],
                region: []
            },

            // 生成設定
            duration: 30,

            // 状態管理
            isGenerating: false,
            generatedMusic: false,
            progress: 0,
            generatingMessage: 'プロンプトを生成中...',

            // 結果データ
            generatedPrompt: '',
            audioUrl: '',
            downloadUrl: '',
            generationTime: 0,
            fileSize: '0 MB',

            // メソッド
            formatTime(seconds) {
                const min = Math.floor(seconds / 60);
                const sec = seconds % 60;
                return `${min}:${sec.toString().padStart(2, '0')}`;
            },

            toggleTag(category, tag) {
                if (!this.selectedTags[category]) {
                    this.selectedTags[category] = [];
                }
                const index = this.selectedTags[category].indexOf(tag);
                if (index > -1) {
                    this.selectedTags[category].splice(index, 1);
                } else {
                    // カテゴリごとの最大選択数を制限
                    const maxSelections = {
                        genre: 1,       // ジャンルは排他的（1つのみ）
                        mood: 1,        // ムードも排他的
                        scene: 2,       // シーンは2つまで
                        instrument: 5,  // 楽器は5つまで
                        tempo: 1,       // テンポは排他的
                        era: 1,         // 時代は排他的
                        region: 1       // 地域は排他的
                    };
                    const maxCount = maxSelections[category] || 3;
                    if (this.selectedTags[category].length < maxCount) {
                        this.selectedTags[category].push(tag);
                    }
                }
            },

            canGenerate() {
                return Object.values(this.selectedTags).some(tags => tags.length > 0);
            },

            async generateMusic() {
                this.isGenerating = true;
                this.progress = 0;

                // プログレスシミュレーション
                const progressInterval = setInterval(() => {
                    if (this.progress < 90) {
                        this.progress += Math.random() * 15;

                        if (this.progress > 30) {
                            this.generatingMessage = '音楽を生成中...';
                        }
                        if (this.progress > 60) {
                            this.generatingMessage = 'マスタリング中...';
                        }
                    }
                }, 500);

                try {
                    // APIリクエストデータ準備
                    const requestData = {
                        genre_tags: this.selectedTags.genre || [],
                        mood_tags: this.selectedTags.mood || [],
                        scene_tags: this.selectedTags.scene || [],
                        instrument_tags: this.selectedTags.instrument || [],
                        tempo_tags: this.selectedTags.tempo || [],
                        era_tags: this.selectedTags.era || [],
                        region_tags: this.selectedTags.region || [],
                        duration_seconds: this.duration
                    };

                    // API呼び出し
                    const response = await fetch('/api/generate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(requestData)
                    });

                    const data = await response.json();

                    clearInterval(progressInterval);
                    this.progress = 100;
                    this.isGenerating = false;

                    if (data.success) {
                        this.generatedMusic = true;
                        this.generatedPrompt = data.prompt;

                        // Base64音声データがある場合はオーディオURLを作成
                        if (data.audio_data) {
                            console.log('Audio data length:', data.audio_data.length);

                            // データURLとして直接設定する方法も試す
                            this.audioUrl = 'data:audio/mpeg;base64,' + data.audio_data;
                            console.log('Audio URL created as data URL');

                            // Blobも作成（ダウンロード用）
                            const audioBlob = this.base64ToBlob(data.audio_data, 'audio/mpeg');
                            console.log('Blob size:', audioBlob.size);
                            this.downloadUrl = URL.createObjectURL(audioBlob);
                        } else {
                            console.log('No audio data in response');
                        }

                        this.generationTime = data.generation_time ? data.generation_time.toFixed(1) : '0';
                        this.fileSize = data.file_size_bytes ?
                            `${(data.file_size_bytes / 1024 / 1024).toFixed(1)} MB` : '0 MB';
                    } else {
                        alert(`生成エラー: ${data.error_message || '不明なエラー'}`);
                    }
                } catch (error) {
                    clearInterval(progressInterval);
                    this.isGenerating = false;
                    console.error('生成エラー:', error);
                    alert('音楽生成中にエラーが発生しました');
                }
            },

            base64ToBlob(base64, mimeType) {
                const byteCharacters = atob(base64);
                const byteNumbers = new Array(byteCharacters.length);
                for (let i = 0; i < byteCharacters.length; i++) {
                    byteNumbers[i] = byteCharacters.charCodeAt(i);
                }
                const byteArray = new Uint8Array(byteNumbers);
                return new Blob([byteArray], { type: mimeType });
            },


            resetGenerator() {
                this.generatedMusic = false;
                this.selectedTags = {
                    genre: [],
                    mood: [],
                    scene: [],
                    instrument: [],
                    tempo: [],
                    era: [],
                    region: []
                };
                this.generatedPrompt = '';
                if (this.audioUrl && this.audioUrl.startsWith('blob:')) {
                    URL.revokeObjectURL(this.audioUrl);
                }
                if (this.downloadUrl && this.downloadUrl.startsWith('blob:')) {
                    URL.revokeObjectURL(this.downloadUrl);
                }
                this.audioUrl = '';
                this.downloadUrl = '';
            },

            // 初期化処理
            async init() {
                try {
                    const response = await fetch('/api/tags');
                    const data = await response.json();
                    console.log('Received tag data:', data);
                    this.tagData = data;

                    // カテゴリごとにタグを整理（オブジェクト全体を保持）
                    if (data.genre && data.genre.tags) {
                        this.genres = data.genre.tags;
                        console.log('Genres:', this.genres);
                    }
                    if (data.mood && data.mood.tags) {
                        this.moods = data.mood.tags;
                        console.log('Moods:', this.moods);
                    }
                    if (data.scene && data.scene.tags) {
                        this.scenes = data.scene.tags;
                        console.log('Scenes:', this.scenes);
                    }
                    if (data.instrument && data.instrument.tags) {
                        this.instruments = data.instrument.tags;
                    }
                    if (data.tempo && data.tempo.tags) {
                        this.tempos = data.tempo.tags;
                    }
                    if (data.era && data.era.tags) {
                        this.eras = data.era.tags;
                    }
                    if (data.region && data.region.tags) {
                        this.regions = data.region.tags;
                    }

                    this.isLoading = false;
                } catch (error) {
                    console.error('タグデータの取得に失敗:', error);
                    // フォールバックデータ
                    this.genres = ['RPG', 'アクション', 'パズル', 'ホラー', 'アドベンチャー'];
                    this.moods = ['エピック', 'ミステリアス', 'エネルギッシュ', 'リラックス', 'ダーク'];
                    this.scenes = ['戦闘', 'タイトル', 'ボス戦', '探索', 'エンディング'];
                    this.isLoading = false;
                }
            }
        }
    }

    // スクロールアニメーションのトリガー
    document.addEventListener('DOMContentLoaded', () => {
        console.log('DOM loaded, initializing animations...');

        // パーティクルエフェクトを生成
        createParticles();

        // すべての要素を表示状態にする（アニメーションで隠れている場合の対策）
        const allElements = document.querySelectorAll('.feature-card, .step-item');
        allElements.forEach(el => {
            el.style.opacity = '1';
            el.style.visibility = 'visible';
        });

        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    console.log('Element intersecting:', entry.target);
                    entry.target.classList.add('visible');
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        // 監視対象の要素を登録
        const animatedElements = document.querySelectorAll('.animate-on-scroll');
        console.log('Found animated elements:', animatedElements.length);

        animatedElements.forEach(el => {
            observer.observe(el);
        });

        // パララックス効果
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const parallax = document.querySelectorAll('.parallax');

            parallax.forEach(el => {
                const speed = el.dataset.speed || 0.5;
                el.style.transform = `translateY(${scrolled * speed}px)`;
            });
        });

        // タイピングアニメーション
        const typeWriter = (element, text, speed = 50) => {
            let i = 0;
            element.textContent = '';

            const type = () => {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            };

            type();
        };

        // ページロード時のアニメーション
        const heroTitle = document.querySelector('.hero-title');
        if (heroTitle) {
            setTimeout(() => {
                heroTitle.classList.add('animate-fade-in-up');
            }, 100);
        }
    });

    // インタラクティブなサウンドビジュアライザー
    function createVisualizer() {
        const canvas = document.createElement('canvas');
        canvas.className = 'absolute inset-0 w-full h-full opacity-30';
        const ctx = canvas.getContext('2d');

        const bars = [];
        const barCount = 50;

        for (let i = 0; i < barCount; i++) {
            bars.push({
                height: Math.random() * 100 + 50,
                targetHeight: Math.random() * 100 + 50,
                color: `hsl(${260 + Math.random() * 60}, 70%, 60%)`
            });
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const barWidth = canvas.width / barCount;

            bars.forEach((bar, index) => {
                bar.height += (bar.targetHeight - bar.height) * 0.1;

                if (Math.random() > 0.95) {
                    bar.targetHeight = Math.random() * 100 + 50;
                }

                ctx.fillStyle = bar.color;
                ctx.fillRect(
                    index * barWidth,
                    canvas.height - bar.height,
                    barWidth - 2,
                    bar.height
                );
            });

            requestAnimationFrame(animate);
        }

        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        animate();

        return canvas;
    }

    // パーティクルエフェクトを生成
    function createParticles() {
        const container = document.getElementById('particles-container');
        if (!container) return;

        const particleCount = 30;

        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 10 + 's';
            particle.style.animationDuration = (10 + Math.random() * 10) + 's';

            // ランダムな色とサイズ
            const colors = ['#8b5cf6', '#ec4899', '#3b82f6'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            const size = Math.random() * 4 + 2;

            particle.style.width = size + 'px';
            particle.style.height = size + 'px';
            particle.style.background = color;
            particle.style.borderRadius = '50%';
            particle.style.boxShadow = `0 0 ${size * 2}px ${color}`;

            container.appendChild(particle);
        }
    }

    // ローディングアニメーション用のスタイル
    const style = document.createElement('style');
    style.textContent = `
    @keyframes loading {
        0% { width: 0%; }
        50% { width: 100%; }
        100% { width: 0%; }
    }
`;
    document.head.appendChild(style);
</script>
{% endblock %}
